services:
    journal_domain:
        class: Ojs\Common\Model\JournalDomain
    kernel.listener.domain_listener:
       class: Ojs\Common\Listener\DomainListener
       arguments: 
            - "@journal_domain"
            - @doctrine.orm.entity_manager
            - "%base_host%"
       tags:
            -
                name: kernel.event_listener
                method: onKernelRequest
                event: kernel.request
    listener.requestresponse:
        class: Ojs\Common\Listener\UserListener
        arguments: [ @service_container, @router ]
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest }
    ojstr_locale.locale_listener:
        class: Ojs\Common\Listener\LocaleListener
        arguments: ["%kernel.default_locale%"]
        tags:
            - { name: kernel.event_subscriber }
    ojstr.twig.ojs_extension:
        class: Ojs\Common\Twig\OjsExtension
        arguments: [@service_container]
        tags:
            - { name: twig.extension }
    ojstr.loginlistener:
        class: Ojstr\UserBundle\Listeners\LoginListener
        arguments: [@doctrine.orm.entity_manager,@service_container]
        tags:
            - { name: kernel.event_listener, event: security.interactive_login } 
    ojstr.security_switch_user:
        class: Ojs\Common\Listener\SecuritySwitchUserListener
        arguments: [@security.context]
        tags:
            - { name: kernel.event_listener, event: security.switch_user, method: onSecuritySwitchUser }
    ojstr.ojs_upload_listener:
        class: Ojs\Common\Listener\UploadListener
        arguments: ["%kernel.root_dir%"]
        tags:
            - { name: kernel.event_listener, event: oneup_uploader.post_persist, method: onUpload }
    ojstr.ojs_mailer:
        class: Ojstr\UserBundle\Controller\MailController
        arguments: [@service_container, @mailer]
#    apikey_authenticator:
#        class:     Ojstr\ApiBundle\Security\ApiKeyAuthenticator
#        arguments: ["@api_key_user_provider"]