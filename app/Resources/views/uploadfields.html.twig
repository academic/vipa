{#
The id on the row and the attribute data-row-id are important. They are used in the js code.
Same thing for all classes starting with jb_
#}

{% block jb_file_ajax_row %}
    <div id="{{ id }}_row" class="file-upload">
        <div class="alert alert-danger jb_result_error" style="display: none;"></div>
        {{- form_label(form) -}}
        {{- form_errors(form) -}}
        {{- form_widget(form) -}}
    </div>
{% endblock %}

{% block jb_file_ajax_widget %}
    <div class="jb_loading progress" style="display: none">
        <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
            <span class="sr-only">45% Complete</span>
        </div>
    </div>

    {% if download_link %}
        <br>
        {% if file_history is not null %}
            <a class="jb_result_preview btn btn-default btn-lg" data-default="#no-preview" href="{{ file_history_url }}">
                <i class="fa fa-file-text"></i>
                <span class="jb_result_name">{{ file_history.originalName }}</span>
            </a>
        {% else %}
            <a class="jb_result_preview btn btn-default btn-lg" data-default="#no-preview" href="#no-preview">
                <i class="fa fa-file-text"></i>&nbsp;
                <span class="jb_result_name"></span>
            </a>
        {% endif %}
    {% endif %}

    <br>
    <span class="fileinput-button">
        <a class="btn btn-success btn-sm" href="#importFile">
            <i class="fa fa-upload"></i>
            {{ 'Import a file'|trans({}, translation_domain) }}
        </a>
        <input
                class="jb_fileupload"
                type="file"
                name="{{ id }}_file"
                data-url="{{ oneup_uploader_endpoint(endpoint) }}"
                data-row-id="{{ id }}_row"
                data-use-crop="{{ use_crop ? "true" : "false" }}"/>
    </span>
    {% if remove_link %}
        <a class="btn btn-danger btn-sm file-remove-button" href="#removePicture" class="jb_remove_link">
            <i class="fa fa-trash"></i>
            {{ 'Remove'|trans({}, translation_domain) }}
        </a>
    {% endif %}
    <input type="hidden" {{ block('widget_attributes') }} {% if value is not empty %}value="{{ value }}" {% endif %}/>
    
    <br><br>
{% endblock %}

{% block jb_image_ajax_widget %}
    {% set previewSrc = asset(default_image) %}
    {% if file_history is not null %}
        {% set previewSrc = file_history_url %}
    {% endif %}
    <img class="jb_result_preview"
         src="{{ previewSrc }}"
         data-default="{{ asset(default_image) }}"
         {% if img_width is defined %}width="{{ img_width }}"{% endif %}
            {% if img_height is defined %}height="{{ img_height }}"{% endif %} />

    {{ block('jb_file_ajax_widget') }}
{% endblock %}

{% block jb_crop_image_ajax_widget %}
    <div class="jb_crop_upload">
        {{ block('jb_image_ajax_widget') }}
    </div>
    <div class="jb_crop_tool" style="display: none;">
        <img class="jb_crop_img" src="" {{ block('jb_crop_attributes') }}
             style="max-width: {{ max_width }}px; max-height: {{ max_height }}px;"/>
        <br>
        <button class="jb_crop_confirm btn btn-success btn-sm">
            <i class="fa fa-check"></i>
            {{ confirm_button_label|trans({}, translation_domain) }}
        </button>
        {% if reset_button %}
            <button type="submit" class="jb_crop_reset btn btn-primary btn-sm">
                <i class="fa fa-refresh"></i>
                {{ reset_button_label|trans({}, translation_domain) }}
            </button>
        {% endif %}
        <input type="hidden" class="jb_crop_field jb_crop_x" name="jb_fileuploader_crop[x]" value=""/>
        <input type="hidden" class="jb_crop_field jb_crop_y" name="jb_fileuploader_crop[y]" value=""/>
        <input type="hidden" class="jb_crop_field jb_crop_width" name="jb_fileuploader_crop[width]" value=""/>
        <input type="hidden" class="jb_crop_field jb_crop_height" name="jb_fileuploader_crop[height]" value=""/>
        <input type="hidden" class="jb_crop_field jb_crop_filename" name="jb_fileuploader_crop[filename]" value=""/>
    </div>
{% endblock %}

{% block jb_crop_attributes -%}
    {% for key, option in crop_options %}
        data-{{ key }}="{{ option }}"
    {% endfor %}
    data-url="{{ jb_fileuploader_crop_endpoint(endpoint) }}"
{%- endblock %}