language: php

node_js:
   - "0.10.x"
php:
  - 5.5

services:
  - mysql
  - mongodb
  - elasticsearch

before_script:
# Install php packages
  - sudo apt-get update > /dev/null
  - phpenv config-add phpmongodb.ini
  - composer self-update
  - composer install --dev --no-interaction --prefer-dist
  - mysql -e "create database ojs;" -uroot
  - mysql -e "CREATE USER 'ojs'@'127.0.0.1' IDENTIFIED BY 'ojs';" -uroot
  - mysql -e "GRANT ALL PRIVILEGES ON * . * TO 'ojs'@'localhost';" -uroot
  - php app/console ojs:install:travis
  - npm install -g bower
  - bower install -f
  - chmod -R 777 app/cache app/logs
  - app/console --env=dev cache:warmup
  - php app/console assets:install web --symlink
  - app/console assetic:dump
  - php app/console h4cc_alice_fixtures:load:sets

script: phpunit -c app
