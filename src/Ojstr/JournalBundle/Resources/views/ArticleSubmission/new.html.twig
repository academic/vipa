{% extends '::ojsbase.html.twig' %}
{% block stylesheets %}
{{parent()}}
<link rel="stylesheet" href="//cdn.jsdelivr.net/select2/3.4.8/select2.css" type="text/css" />
<link rel="stylesheet" href="/vendor/bootstrap3-wysihtml5-bower/dist/bootstrap3-wysihtml5.css" type="text/css" />

{% endblock %}

 {% block breadbrump %}
<ol class="breadcrumb">
    <li> Dashboard</li>
    <li><a href="#" class="active">Submit Article</a></li>
</ol> 
{% endblock %}

{% block body -%}

<div class="col-md-12"> 
    <div class="panel panel-default">
        <div class="panel-heading">
            <div class="panel-title">
                <ul class='nav nav-wizard'>
                    <li class="active"><a href='#step1'><!--data-toggle="tab"-->
                            <span class="badge">1</span> Article Info.</a></li>
                    <li><span class="badge">2</span> Citations</li>
                    <li><span class="badge">3</span> Authors</li>
                    <li><span class="badge">4</span> Article File</li>
                    <li class="laststep"><span class="badge">5</span> Preview & <strong>Submit</strong></li>
                </ul>
            </div>
        </div>

        <div class="panel-body">  
            <!-- Nav tabs -->
            <ul id="mainTabs" class="nav nav-tabs" role="tablist">
                <li id="t_en" class="lang active"><a href="#en" role="tab" data-toggle="tab">En</a></li>

                <li class="lang dropdown">
                    <a href="#" id="languageDrop" class="dropdown-toggle" 
                       data-toggle="dropdown">
                        <i class="glyphicon glyphicon-plus"></i> Add language 
                        <span class="caret"></span>
                    </a>
                    <ul id="languageDropList" class="dropdown-menu" role="menu" aria-labelledby="languageDrop">
                        <li><a href="#" code="tr" lang="Turkish" tabindex="-1">Turkish (tr)</a></li>
                        <li><a href="#" code="fr" lang="French" tabindex="-1">French (fr)</a></li>
                        <li><a href="#" code="it" lang="Italian" tabindex="-1">Italian (it)</a></li>
                    </ul>
                </li> 
            </ul>

            <!-- Tab panes -->
            <div class="tab-content" id="langtabs">
                <div class="tab-pane active" id="en"> 
                    {% include 'OjstrJournalBundle:ArticleSubmission:newform.html.twig' %}
                </div>

            </div>

            <div class="record_actions">
                <a class="btn btn-default btn-lg" onclick="return confirm('Are you sure?');" href="{{ path('articlesubmission_new') }}">
                    {% trans %}Restart{% endtrans %}
                </a>

                <a class="btn btn-primary btn-lg pull-right" href="{{ path('articlesubmission_new') }}">
                    {% trans %}Save & Next {% endtrans %}
                    <i class="glyphicon glyphicon-chevron-right"></i>
                </a>
            </div>
        </div>
    </div> 
</div>

<div class="hidden" id="formtpl">
    {% include 'OjstrJournalBundle:ArticleSubmission:newform.html.twig' %}
</div>
{% endblock %}

{% block javascripts %}
    {{parent()}}
<script src="//cdn.jsdelivr.net/select2/3.4.8/select2.min.js"></script>
<script src="/vendor/bootstrap3-wysihtml5-bower/dist/bootstrap3-wysihtml5.all.min.js"></script>
<script>
                    var languages = ["en"];
                    $(document).ready(function() {
                        $("ul#mainTabs li a").click(function(e) {
                            e.preventDefault();
                        });
                        $("ul#languageDropList li a").click(function(e) {
                            e.preventDefault();
                            langcode = $(this).attr('code');
                            langtitle = $(this).attr('lang');
                            // check if selected language tab already exists
                            if (OjstrCommon.inArray(langcode, languages)) {
                                return false;
                            }
                            $("#langtabs").append('<div class="tab-pane" id="' + langcode + '">' + $("#formtpl").html() + '...</div>');
                            languages.push(langcode);
                            tabhtml = '<li class="lang" id="t_' + langcode + '"><a href="#' + langcode + '" role="tab" class="lang" data-toggle="tab">' + langtitle + '</a></li>';
                            $("ul#mainTabs li.lang").last().before(tabhtml);
                        });

                        $("#langtabs a.removelang").click(function(e) {
                            check = confirm("Are you sure to remove this language tab?");
                            if (!check) {
                                return false;
                            }
                            e.preventDefault();
                            langcode = $(this).parent().attr('id');
                            for (var i in languages) {
                                console.log(languages[i]);
                                if (languages[i] === langcode) {
                                    languages.splice(i, 1);
                                }
                            }
                            $(this).parent().remove();
                            $('#t_' + langcode).remove();
                            firsttab = $("#langtabs .tab-pane").first().attr('id');
                            if (firsttab) {
                                $("li.lang a[href=#" + firsttab + "]").tab("show");
                            }
                        });

                        $('select').select2({placeholder: '', allowClear: true, closeOnSelect: false});
                        $("textarea").wysihtml5({
                            toolbar: {
                                "font-styles": false,
                                "emphasis": true,
                                "lists": false,
                                "html": false,
                                "link": true,
                                "image": false,
                                "color": false,
                                "blockquote": false
                            }
                        });

                    });

</script>
{% endblock %}